<!-- <!DOCTYPE html>
<html>
<head>
  <title>Invoice List</title>
  <style>
    body { font-family: Arial; padding:20px; }
    table { border-collapse: collapse; width:100%; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align:center; }
    th { background-color: #f2f2f2; }
    button { padding:5px 10px; cursor:pointer; }
  </style>
</head>
<body>
  <h2>Invoice List</h2>
  <table id="invoiceTable">
    <thead>
      <tr>
        <th>Invoice Number</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    // Google Apps Script Web App URL that serves invoice list JSON
    const appsScriptUrl = "https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec";

    // Fetch invoices from Google Sheet
    fetch(`${appsScriptUrl}?action=getInvoices`)
      .then(res => res.json())
      .then(invoices => {
        const tbody = document.querySelector("#invoiceTable tbody");
        invoices.forEach(inv => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${inv}</td>
            <td>
              <button onclick="openInvoice('${inv}')">View / Print / Download</button>
            </td>
          `;
          tbody.appendChild(tr);
        });
      });

    // Open invoice in new popup window
    function openInvoice(invoiceId) {
      const url = `https://script.google.com/macros/s/AKfycbwz3lgGS7yk1_9yUEk-ORLHaahtrkYxjtdEkqC8JVsYg37N11RD_CJVnp9YmXL7_u8/exec?invoiceId=${invoiceId}`;
      window.open(url, "_blank", "width=900,height=600,scrollbars=yes");
    }
  </script>
</body>
</html> -->



<!-- <!DOCTYPE html>
<html>
<head>
  <title>Invoice List</title>
  <style>
    body { font-family: Arial; padding:20px; background:#f9f9f9; }
    h2 { text-align:center; }
    table { border-collapse: collapse; width: 80%; margin: auto; background: #fff; }
    th, td { border: 1px solid #ddd; padding: 10px; text-align:center; }
    th { background-color: #f2f2f2; }
    button { padding: 5px 10px; cursor: pointer; }
  </style>
</head>
<body>
  <h2>Invoice List</h2>
  <table id="invoiceTable">
    <thead>
      <tr>
        <th>Invoice Number</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    // List of invoice numbers
    const invoices = [
      "INV-1001",
      "INV-1002",
      "INV-1003",
      "INV-1004"
    ];

    const baseUrl = "https://prhardware.shop/EMI-software/invoice";

    const tbody = document.querySelector("#invoiceTable tbody");

    invoices.forEach(inv => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${inv}</td>
        <td>
          <button onclick="openInvoice('${inv}')">View / Print / Download</button>
        </td>
      `;
      tbody.appendChild(tr);
    });

    function openInvoice(invoiceId) {
      const pdfUrl = `${baseUrl}/${invoiceId}.pdf`;

      // Open PDF in new popup window with Print & Download options
      const w = window.open("", "_blank", "width=900,height=600,scrollbars=yes");
      w.document.write(`
        <html>
        <head>
          <title>Invoice ${invoiceId}</title>
          <style>
            html, body { margin:0; padding:0; height:100%; font-family: Arial; }
            iframe { width:100%; height:100%; border:none; }
            .header { padding: 10px; background: #f1f1f1; text-align:center; font-size:18px; position:fixed; width:100%; top:0; z-index:10; }
            .actions { position:fixed; top:10px; right:10px; z-index:20; }
            .actions button { padding:5px 10px; margin-left:5px; }
            .content { margin-top:50px; height:calc(100% - 50px); }
          </style>
        </head>
        <body>
          <div class="header">Invoice ${invoiceId}</div>
          <div class="actions">
            <button onclick="window.print()">Print PDF</button>
            <button onclick="window.open('${pdfUrl}', '_blank')">Download PDF</button>
          </div>
          <div class="content">
            <iframe src="${pdfUrl}"></iframe>
          </div>
        </body>
        </html>
      `);
      w.document.close();
    }
  </script>
</body>
</html> -->


<!-- <!DOCTYPE html>
<html>
<head>
  <title>Invoice List</title>
  <style>
    body { font-family: Arial; padding:20px; background:#f9f9f9; }
    h2 { text-align:center; }
    table { border-collapse: collapse; width: 80%; margin: auto; background: #fff; }
    th, td { border: 1px solid #ddd; padding: 10px; text-align:center; }
    th { background-color: #f2f2f2; }
    a.button {
      text-decoration: none;
      background-color: #4CAF50;
      color: white;
      padding: 5px 10px;
      border-radius: 3px;
    }
    a.button:hover { background-color: #45a049; }
  </style>
</head>
<body>
  <h2>Invoice List</h2>
  <table id="invoiceTable">
    <thead>
      <tr>
        <th>Invoice Number</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    // List of invoice numbers
    const invoices = ["INV-1001", "INV-1002", "INV-1003", "INV-1004"];

    const baseUrl = "https://prhardware.shop/EMI-software/invoice";
    const tbody = document.querySelector("#invoiceTable tbody");

    invoices.forEach(inv => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${inv}</td>
        <td>
          <a class="button" href="${baseUrl}/${inv}.pdf" target="_blank">View / Download PDF</a>
        </td>
      `;
      tbody.appendChild(tr);
    });
  </script>
</body>
</html> -->

<!-- <!DOCTYPE html>
<html>
<head>
  <title>Invoice List</title>
  <style>
    body { font-family: Arial; padding:20px; background:#f9f9f9; }
    h2 { text-align:center; }
    table { border-collapse: collapse; width: 80%; margin: auto; background: #fff; }
    th, td { border: 1px solid #ddd; padding: 10px; text-align:center; }
    th { background-color: #f2f2f2; }
    a.button {
      text-decoration: none;
      background-color: #4CAF50;
      color: white;
      padding: 5px 10px;
      border-radius: 3px;
    }
    a.button:hover { background-color: #45a049; }
  </style>
</head>
<body>
  <h2>Invoice List</h2>
  <table id="invoiceTable">
    <thead>
      <tr>
        <th>Invoice Number</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    // Google Apps Script Web App URL
    const appsScriptUrl = "https://script.google.com/macros/s/AKfycbxxRpOFkc-urR-7_eTerw2H_BaLp573qZ3Cu8o6_MFgTYXSlr3yUFJ0YJ987oxgeWTB/exec";

    fetch(`${appsScriptUrl}?action=getInvoices`)
      .then(res => res.json())
      .then(invoices => {
        const tbody = document.querySelector("#invoiceTable tbody");
        invoices.forEach(inv => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${inv}</td>
            <td>
              <a class="button" href="${appsScriptUrl}?invoiceId=${inv}" target="_blank">
                View / Download PDF
              </a>
            </td>
          `;
          tbody.appendChild(tr);
        });
      });
  </script>
</body>
</html> -->


<!DOCTYPE html>
<html>
<head>
<title>Invoice Viewer</title>
<style>
  body, html {
    margin:0;
    padding:0;
    width:100%;
    height:100%;
  }
  iframe {
    position: fixed;
    top: 0;
    left: 0;
    border: none;
    width: 100vw;
    height: 100vh;
  }
</style>
</head>

<body>
<iframe id="myIframe" src=""></iframe>




 

<script>



   // Read invoiceId from URL like ?invoiceId=INV-1001
  function getInvoiceId() {
    const params = new URLSearchParams(window.location.search);
    return params.get("invoiceId");
  }

  window.onload = function () {
    const invoiceId = getInvoiceId();

    if (!invoiceId) {
      alert("Missing invoiceId");
      return;
    }

    
  function extractInvoiceId() {
    const path = window.location.pathname;

    // Match /EMI-software/invoice/INV-1001.pdf
    const regex = /^\/EMI-software\/invoice\/(.+)\.pdf$/;

    const match = path.match(regex);

    if (!match) {
      console.log("Regex failed:", path);
      return null;
    }

    return match[1]; // Returns: INV-1001
  }

  window.onload = function () {
    const invoiceId = extractInvoiceId();

    if (!invoiceId) {
      alert("Invalid Invoice URL Format!");
      return;
    }

    // Apps Script deployed URL
    const baseUrl =
      "https://script.google.com/macros/s/AKfycbzkpGpFrlzmfIlEFswlnAYB43coovOUXkOAXcDiIjghKE6SVwX3aSKYVvnrTOLH6v8W9w/exec";

    const iframeUrl = `${baseUrl}?options=InvoiceDetails&invoiceId=${encodeURIComponent(invoiceId)}`;

    document.getElementById("myIframe").src = iframeUrl;
  };
</script>

</body>
</html>




