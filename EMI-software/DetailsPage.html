<!DOCTYPE html>
<html>
<head>
  <title>Details Page</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      overflow: hidden;
    }
    iframe {
      position: fixed;
      top: 0;
      left: 0;
      border: none;
      width: 100vw;
      height: 100vh;
    }
  </style>
</head>
<body>

<!-- <iframe id="myIframe" src=""></iframe>

<script>
  function getIdFromQuery() {
    const params = new URLSearchParams(window.location.search);
    return params.get("id");
  }

  window.onload = function() {
    const id = getIdFromQuery();
    if (!id) {
      alert("Missing ID");
      return;
    }

    const baseUrl = "https://script.google.com/macros/s/AKfycbwwy3xT99T-oWLCGqWnhHoIs_xQU0hoRl-d8FISPftTKCW7xPMTqLqY1mo7xirAwrnJLg/exec";
    const iframeUrl = `${baseUrl}?options=DetailsPage&id=${encodeURIComponent(id)}`;
    document.getElementById("myIframe").src = iframeUrl;
  };
</script> -->

  <iframe id="myIframe" src="" style="width:100%; height:100vh; border:none;"></iframe>

<script>
  function getIdFromPdfURL() {
    // Example path: /EMI-software/invoice/INV-1001.pdf
    const path = window.location.pathname;

    const parts = path.split("/");
    const filename = parts[parts.length - 1];   // INV-1001.pdf

    if (!filename.endsWith(".pdf")) {
      return null;
    }

    // Remove .pdf â†’ return INV-1001
    return filename.replace(".pdf", "");
  }

  window.onload = function() {
    const id = getIdFromPdfURL();

    if (!id) {
      alert("Invalid or Missing Invoice ID");
      return;
    }

    const baseUrl = "https://script.google.com/macros/s/AKfycbzkpGpFrlzmfIlEFswlnAYB43coovOUXkOAXcDiIjghKE6SVwX3aSKYVvnrTOLH6v8W9w/exec";

    const iframeUrl = `${baseUrl}?options=DetailsPage&id=${encodeURIComponent(id)}`;

    document.getElementById("myIframe").src = iframeUrl;
  };
</script>


</body>
</html>
