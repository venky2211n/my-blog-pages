

<!-- <!DOCTYPE html>
<html>
<head>
  <title>Invoice Viewer</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      overflow: hidden;
    }
    iframe {
      position: fixed;
      top: 0;
      left: 0;
      border: none;
      width: 100vw;
      height: 100vh;
    }
  </style>
</head>
<body>

<iframe id="myIframe"></iframe>

<script>
  function getInvoiceIdFromQuery() {
    const params = new URLSearchParams(window.location.search);
    return params.get("invoiceId");  // <-- FIXED
  }

  window.onload = function() {
    const invoiceId = getInvoiceIdFromQuery();
    if (!invoiceId) {
      alert("Missing invoiceId");
      return;
    }

    const baseUrl = "https://script.google.com/macros/s/AKfycbzkpGpFrlzmfIlEFswlnAYB43coovOUXkOAXcDiIjghKE6SVwX3aSKYVvnrTOLH6v8W9w/exec";
    const iframeUrl = `${baseUrl}?options=InvoiceDetails&invoiceId=${encodeURIComponent(invoiceId)}`;

    document.getElementById("myIframe").src = iframeUrl;
  };
</script>

</body>
</html> -->



<!-- <!DOCTYPE html>
<html>
<head>
  <title>Invoice Viewer</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      overflow: hidden;
    }
    iframe {
      position: fixed;
      top: 0;
      left: 0;
      border: none;
      width: 100vw;
      height: 100vh;
    }
  </style>
</head>
<body>

<iframe id="myIframe" src=""></iframe>

<script>
  // 1️⃣ Extract from query: ?invoiceId=INV-1001
  function getInvoiceIdFromQuery() {
    const params = new URLSearchParams(window.location.search);
    return params.get("invoiceId");
  }

  // 2️⃣ Extract from path: /invoice/INV-1001.pdf
  function getInvoiceIdFromPdfUrl() {
    const path = window.location.pathname;  
    // Split into parts
    const parts = path.split("/");
    const last = parts.pop() || parts.pop();  // handles trailing slash

    if (last && last.endsWith(".pdf")) {
      return last.replace(".pdf", "");  // Remove .pdf → INV-1001
    }
    return null;
  }

  window.onload = function() {
    let invoiceId = getInvoiceIdFromQuery();

    // If not found in query, try PDF URL
    if (!invoiceId) {
      invoiceId = getInvoiceIdFromPdfUrl();
    }

    if (!invoiceId) {
      alert("❌ Invoice ID not found in URL");
      return;
    }

    // Your Apps Script Web App URL
    const baseUrl =
      "https://script.google.com/macros/s/AKfycbzkpGpFrlzmfIlEFswlnAYB43coovOUXkOAXcDiIjghKE6SVwX3aSKYVvnrTOLH6v8W9w/exec";

    const iframeUrl =
      `${baseUrl}?options=InvoiceDetails&invoiceId=${encodeURIComponent(invoiceId)}`;

    document.getElementById("myIframe").src = iframeUrl;
  };
</script>

</body>
</html> -->


<!-- <!DOCTYPE html>
<html>
<head>
  <title>Invoice Viewer</title>
  <style>
    html, body { margin:0; padding:0; height:100%; width:100%; overflow:hidden; }
    iframe { width:100vw; height:100vh; border:none; position:fixed; top:0; left:0; }
  </style>
</head>
<body>

<iframe id="myIframe"></iframe>

<script>
  function getInvoiceIdFromQuery() {
    const p = new URLSearchParams(window.location.search);
    return p.get("invoiceId");
  }

  function getInvoiceIdFromPath() {
    const path = window.location.pathname;
    const parts = path.split("/");
    const last = parts.pop() || parts.pop();

    if (last.endsWith(".pdf")) {
      return last.replace(".pdf", "");
    }
    return null;
  }

  function loadInvoice() {
    let invoiceId = getInvoiceIdFromQuery();
    if (!invoiceId) invoiceId = getInvoiceIdFromPath();

    if (!invoiceId) {
      document.body.innerHTML = "<h2 style='padding:20px;color:red'>Invoice ID Missing</h2>";
      return;
    }

    const baseUrl =
      "https://script.google.com/macros/s/AKfycbzkpGpFrlzmfIlEFswlnAYB43coovOUXkOAXcDiIjghKE6SVwX3aSKYVvnrTOLH6v8W9w/exec";

    document.getElementById("myIframe").src =
      `${baseUrl}?options=InvoiceDetails&invoiceId=${encodeURIComponent(invoiceId)}`;
  }

  loadInvoice();
</script>

</body>
</html> -->



<!-- <!DOCTYPE html>
<html>
<head>
  <title>Invoice Viewer</title>
  <style>
    html, body {margin:0; padding:0; height:100%; width:100%; overflow:hidden;}
    iframe {width:100vw; height:100vh; border:none; position:fixed; top:0; left:0;}
  </style>
</head>
<body>
<iframe id="myIframe"></iframe>

<script>
  function getInvoiceId() {
    const params = new URLSearchParams(window.location.search);
    if (params.get("invoiceId")) return params.get("invoiceId");

    const path = window.location.pathname.split("/").pop() || "";
    if (path) return path; // SPA clean URL without .pdf
    return null;
  }

  const invoiceId = getInvoiceId();
  if (!invoiceId) {
    document.body.innerHTML = "<h2 style='padding:20px;color:red'>Invoice ID missing</h2>";
  } else {
    const baseUrl = "https://script.google.com/macros/s/AKfycbzkpGpFrlzmfIlEFswlnAYB43coovOUXkOAXcDiIjghKE6SVwX3aSKYVvnrTOLH6v8W9w/exec";
    document.getElementById("myIframe").src = `${baseUrl}?options=InvoiceDetails&invoiceId=${encodeURIComponent(invoiceId)}`;
  }
</script>
</body>
</html> -->


<!DOCTYPE html>
<html>
<head>
<title>Invoice Viewer</title>
<style>
  body, html {
    margin:0;
    padding:0;
    width:100%;
    height:100%;
  }
  iframe {
    position: fixed;
    top: 0;
    left: 0;
    border: none;
    width: 100vw;
    height: 100vh;
  }
</style>
</head>

<body>
<iframe id="myIframe" src=""></iframe>




 

<script>



   // Read invoiceId from URL like ?invoiceId=INV-1001
  function getInvoiceId() {
    const params = new URLSearchParams(window.location.search);
    return params.get("invoiceId");
  }

  window.onload = function () {
    const invoiceId = getInvoiceId();

    if (!invoiceId) {
      alert("Missing invoiceId");
      return;
    }

    
  function extractInvoiceId() {
    const path = window.location.pathname;

    // Match /EMI-software/invoice/INV-1001.pdf
    const regex = /^\/EMI-software\/invoice\/(.+)\.pdf$/;

    const match = path.match(regex);

    if (!match) {
      console.log("Regex failed:", path);
      return null;
    }

    return match[1]; // Returns: INV-1001
  }

  window.onload = function () {
    const invoiceId = extractInvoiceId();

    if (!invoiceId) {
      alert("Invalid Invoice URL Format!");
      return;
    }

    // Apps Script deployed URL
    const baseUrl =
      "https://script.google.com/macros/s/AKfycbzkpGpFrlzmfIlEFswlnAYB43coovOUXkOAXcDiIjghKE6SVwX3aSKYVvnrTOLH6v8W9w/exec";

    const iframeUrl = `${baseUrl}?options=InvoiceDetails&invoiceId=${encodeURIComponent(invoiceId)}`;

    document.getElementById("myIframe").src = iframeUrl;
  };
</script>

</body>
</html>









