<!-- <!DOCTYPE html>
<html>
<head>
<title>Invoice Viewer</title>
<style>
  html, body {
    margin:0;
    padding:0;
    width:100%;
    height:100%;
  }
  iframe {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    border: none;
  }
</style>
</head>

<body>

<iframe id="myIframe"></iframe>

<script>
  // Extract "invoiceId=INV-1001" from the URL path
  function extractInvoiceIdFromPath() {
    const path = window.location.pathname;  
    // Example path: /EMI-software/invoice/invoiceId=INV-1001
    const parts = path.split("/");
    const lastPart = parts[parts.length - 1]; // invoiceId=INV-1001

    if (lastPart.startsWith("invoiceId=")) {
      return lastPart.split("=")[1]; // INV-1001
    }
    return null;
  }

  window.onload = function() {
    const invoiceId = extractInvoiceIdFromPath();

    if (!invoiceId) {
      alert("Missing invoiceId in URL");
      return;
    }

    // YOUR APPS SCRIPT WEB APP URL
    const baseUrl = 
      "https://script.google.com/macros/s/AKfycbzD7623BSRp7fBclO0cTDLMTmlNJLuia3-Um9BckMurTYP9YSxb-QsrzRoQCZUS09tA/exec";

    document.getElementById("myIframe").src =
      `${baseUrl}?invoiceId=${encodeURIComponent(invoiceId)}`;
  };
</script>

</body>
</html> -->


<!DOCTYPE html>
<html>
<head>
<title>Invoice Viewer</title>
<style>
  html, body {
    margin:0;
    padding:0;
    width:100%;
    height:100%;
  }
  iframe {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    border: none;
  }
</style>
</head>

<body>

<iframe id="myIframe"></iframe>

<script>
  function extractInvoiceId() {
    const fullPath = window.location.pathname; 
    // Example: /EMI-software/invoice/INV-1001.pdf

    const parts = fullPath.split("/");  
    const filename = parts[parts.length - 1];  
    // filename = "INV-1001.pdf"

    if (!filename.endsWith(".pdf")) return null;

    return filename.replace(".pdf", "");  
    // â†’ returns "INV-1001"
  }

  window.onload = function () {
    const invoiceId = extractInvoiceId();
    if (!invoiceId) {
      alert("Invalid invoice URL");
      return;
    }

    // YOUR APPS SCRIPT WEB APP URL
    const baseUrl =
      "https://script.google.com/macros/s/AKfycbykBcuMm8Gu1rEZ1BFECd9aA-eFaHcV3ytJpxO3SrLcg6R_kTtJ9Kl3Eoiwqhcfl-Wj/exec";

    const iframeUrl = `${baseUrl}?options=InvoiceDetails&invoiceId=${encodeURIComponent(invoiceId)}`;

    document.getElementById("myIframe").src = iframeUrl;
  };
</script>



</body>
</html>




