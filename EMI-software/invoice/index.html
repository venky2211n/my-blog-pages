//https://prhardware.shop/EMI-software/invoice/?invoiceId=INV-1001

<!-- <!DOCTYPE html>
<html>
<head>
  <title>Invoice Viewer</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      overflow: hidden;
    }
    iframe {
      position: fixed;
      top: 0;
      left: 0;
      border: none;
      width: 100vw;
      height: 100vh;
    }
  </style>
</head>
<body>

<iframe id="myIframe"></iframe>

<script>
  function getInvoiceIdFromQuery() {
    const params = new URLSearchParams(window.location.search);
    return params.get("invoiceId");  // <-- FIXED
  }

  window.onload = function() {
    const invoiceId = getInvoiceIdFromQuery();
    if (!invoiceId) {
      alert("Missing invoiceId");
      return;
    }

    const baseUrl = "https://script.google.com/macros/s/AKfycbzkpGpFrlzmfIlEFswlnAYB43coovOUXkOAXcDiIjghKE6SVwX3aSKYVvnrTOLH6v8W9w/exec";
    const iframeUrl = `${baseUrl}?options=InvoiceDetails&invoiceId=${encodeURIComponent(invoiceId)}`;

    document.getElementById("myIframe").src = iframeUrl;
  };
</script>

</body>
</html> -->

//https://prhardware.shop/EMI-software/invoice/?invoiceId=INV-1001
//https://prhardware.shop/EMI-software/invoice/INV-1001.pdf

<!DOCTYPE html>
<html>
<head>
  <title>Invoice Viewer</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      overflow: hidden;
    }
    iframe {
      position: fixed;
      top: 0;
      left: 0;
      border: none;
      width: 100vw;
      height: 100vh;
    }
  </style>
</head>
<body>

<iframe id="myIframe" src=""></iframe>

<script>
  // 1️⃣ Extract from query: ?invoiceId=INV-1001
  function getInvoiceIdFromQuery() {
    const params = new URLSearchParams(window.location.search);
    return params.get("invoiceId");
  }

  // 2️⃣ Extract from path: /invoice/INV-1001.pdf
  function getInvoiceIdFromPdfUrl() {
    const path = window.location.pathname;  
    // Split into parts
    const parts = path.split("/");
    const last = parts.pop() || parts.pop();  // handles trailing slash

    if (last && last.endsWith(".pdf")) {
      return last.replace(".pdf", "");  // Remove .pdf → INV-1001
    }
    return null;
  }

  window.onload = function() {
    let invoiceId = getInvoiceIdFromQuery();

    // If not found in query, try PDF URL
    if (!invoiceId) {
      invoiceId = getInvoiceIdFromPdfUrl();
    }

    if (!invoiceId) {
      alert("❌ Invoice ID not found in URL");
      return;
    }

    // Your Apps Script Web App URL
    const baseUrl =
      "https://script.google.com/macros/s/AKfycbzkpGpFrlzmfIlEFswlnAYB43coovOUXkOAXcDiIjghKE6SVwX3aSKYVvnrTOLH6v8W9w/exec";

    const iframeUrl =
      `${baseUrl}?options=InvoiceDetails&invoiceId=${encodeURIComponent(invoiceId)}`;

    document.getElementById("myIframe").src = iframeUrl;
  };
</script>

</body>
</html>







