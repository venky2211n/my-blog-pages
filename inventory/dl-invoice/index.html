
<!-- <!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Downloading Invoice...</title>
</head>
<body>

<p>Downloading invoice…</p>

<!-- <script>
(function () {

  // -----------------------------
  // GET INVOICE NO FROM URL PATH
  // -----------------------------
  // /inventory/dl-invoice/INV-12345
  const parts = window.location.pathname.split("/");
  const invoiceNo = parts[parts.length - 1];

  if (!invoiceNo || invoiceNo === "dl-invoice") {
    alert("Invoice number missing");
    return;
  }

  // -----------------------------
  // APPS SCRIPT URL
  // -----------------------------
  const scriptUrl =
    "https://script.google.com/macros/s/AKfycbwGo8dk6H6U25aYG5_QJdplaJF-ou4q-fOJ854d-V-mkjjW7BVUtvp0z7mqaIL1XeQV/exec"
    + "?invoiceNo=" + encodeURIComponent(invoiceNo);

  // -----------------------------
  // AUTO DOWNLOAD
  // -----------------------------
  window.location.href = scriptUrl;

})();
<!-- </script> -->

  <!-- <script>
const params = new URLSearchParams(window.location.search);
const invoiceNo = params.get("invoiceNo");

if (!invoiceNo) {
  document.body.innerHTML = "Invoice number missing";
} else {
  window.location.href =
    "https://script.google.com/macros/s/AKfycbz2Uz_JBhk3Nz2h3yLAqwpG6BNVJvB6Z4Wf5fx8EyTzFlNNWuc07FfhGDI7qfxsx3xd/exec" +
    "?invoiceNo=" + encodeURIComponent(invoiceNo);
}
</script> --> 

<!-- </body>
</html> --> 




<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Downloading Invoice…</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 40px;
    }
    iframe {
      display: none;
    }
  </style>
</head>
<body>

<h3>Downloading invoice…</h3>
<p>Please wait</p>

<iframe id="downloadFrame"></iframe>

<script>
(function () {

  const params = new URLSearchParams(window.location.search);
  const invoiceNo = params.get("invoiceNo");

  if (!invoiceNo) {
    document.body.innerHTML = "<h3>Invoice number missing</h3>";
    return;
  }

  const scriptUrl =
    "https://script.google.com/macros/s/AKfycbz2Uz_JBhk3Nz2h3yLAqwpG6BNVJvB6Z4Wf5fx8EyTzFlNNWuc07FfhGDI7qfxsx3xd/exec"
    + "?invoiceNo=" + encodeURIComponent(invoiceNo);

  // ✅ LOAD IN HIDDEN IFRAME → AUTO DOWNLOAD
  document.getElementById("downloadFrame").src = scriptUrl;

})();
</script>

</body>
</html>

